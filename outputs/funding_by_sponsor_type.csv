-- Funding by Sponsor Type 

SELECT s.sponsor_type, COUNT(DISTINCT t.trial_id) AS num_trials,
       SUM(f.amount_million) AS total_funding
FROM trials_2019_2024 t
JOIN sponsors s ON t.sponsor_id = s.sponsor_id
JOIN funding f ON t.sponsor_id = f.sponsor_id
GROUP BY s.sponsor_type
ORDER BY total_funding DESC;
